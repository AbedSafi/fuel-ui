{"version":3,"sources":["components/InfiniteScroller/InfiniteScroller.ts"],"names":[],"mappings":"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","file":"components/InfiniteScroller/InfiniteScroller.js","sourcesContent":["import { \n\tDirective,\n\tComponent,\n\tElementRef, \n\tInput, \n\tOutput, \n\tEventEmitter,\n\tContentChildren,\n\tViewChildren,\n\tQueryList,\n\tAfterContentInit,\n    AfterViewInit\n } from '@angular/core';\n \n import { ElementUtils } from \"../../utilities/ElementUtils\";\n\n@Directive({\n    selector: \"[scroll-item],.scroll-item\"\n})\nexport class ScrollItem implements AfterViewInit {\n    element: HTMLElement;\n    \n    get height(): number {\n        return ElementUtils.outerHeight(this.element);\n    }\n    \n    constructor(element: ElementRef) {\n        this.element = element.nativeElement;\n    }\n    \n    ngAfterViewInit(): void {\n        this.element = <HTMLElement>this.element.firstElementChild;\n    }\n}\n\n@Component({\n\tselector: \"infinite-scroller\",\n\ttemplate: `\n        <div class=\"scroll-outer\" [class.hide-scrollbar]=\"hideScrollbar\">\n            <div class=\"scroll-container\"\n                (scroll)=\"doscroll($event)\"\n                [style.height]=\"height\">\n                <ng-content></ng-content>\n            </div>\n        </div>\n\t`,\n\tstyles: [`\n\t\t.scroll-container {\n\t\t\toverflow-y: scroll;\n\t\t\toverflow-x: hidden;\n            max-height: 100%;\n\t\t}\n\n        .scroll-outer.hide-scrollbar .scroll-container {\n            margin-right: -16px;\n        }\n\n\t\t.scroll-content {\n\t\t\toverflow: auto;\n\t\t}\n\t`],\n\tdirectives: []\n})\nexport class InfiniteScroller \n    implements AfterContentInit, AfterViewInit \n{        \n\t@Input()\n\tdistance: number = 100;\n\t@Input()\n\theight: string = 'auto';\n\t@Input()\n\thideScrollbar: boolean = false;\n\t\n\t@Output()\n\tnext: EventEmitter<any> = new EventEmitter();\n\t\n\t@Output()\n\tprev: EventEmitter<any> = new EventEmitter();\n\t\n    @Output()\n    topIndexChange: EventEmitter<any> = new EventEmitter();\n    topIndex: number = 0;\n    \n    @Output()\n    bottomIndexChange: EventEmitter<any> = new EventEmitter();\n    bottomIndex: number = 0;\n    \n\tlastScroll: number = 0;\n\t\n    @ContentChildren(ScrollItem) \n    itemQuery: QueryList<ScrollItem>;\n    firstItem: ScrollItem;\n\tcontainer: HTMLElement\n\tscrollTarget: HTMLElement;\n    \n    //test\n    \n\tconstructor(element: ElementRef) {\n\t\tthis.container = element.nativeElement;\n\t}\n\t\n\tngAfterContentInit(): void {\n        this.firstItem = this.itemQuery.first;\n        this.itemQuery.changes.subscribe(() => {\n            this.handleItemChanges();\n        });\n\t}\n    \n    ngAfterViewInit(): void {\n        this.container = <HTMLElement>this.container.querySelector(\".scroll-container\");        \n        this.container.scrollTop += 1;\n    }\n    \n\thandleItemChanges() {\n        if(this.firstItem == null)\n            this.firstItem = this.itemQuery.first;\n            \n        if(this.firstItem !== this.itemQuery.first) {\n            this.container.scrollTop += this.itemQuery.first.height;\n            this.firstItem = this.itemQuery.first;\n        }\n    }\n    \n    getVisableIndicies(): void {\n        var itemArray = this.itemQuery.toArray();\n        var visableIndicies = itemArray\n            .filter(i => this.checkVisableItem(i))\n            .map(i => itemArray.indexOf(i));\n        \n        if(visableIndicies.length > 1) {\n            this.topIndex = visableIndicies[0]\n            this.bottomIndex = visableIndicies[visableIndicies.length-1];\n            this.topIndexChange.next(this.topIndex);\n            this.bottomIndexChange.next(this.bottomIndex);\n        }\n        else if(visableIndicies.length > 0) {\n            this.topIndex = visableIndicies[0]\n            this.topIndexChange.next(this.topIndex);\n        }        \n    }\n    \n    checkVisableItem(item: ScrollItem): boolean {                    \n        var itemTop = item.element.offsetTop;  \n        var itemBottom = itemTop + ElementUtils.outerHeight(item.element);\n        var viewTop = this.container.scrollTop + this.container.offsetTop;\n        var viewBottom = viewTop + this.container.clientHeight;\n            \n        if(itemTop > viewTop && itemTop < viewBottom) \n            return true;\n        \n        if(itemBottom > viewTop && itemBottom < viewBottom)\n            return true;\n            \n        if(itemTop < viewTop && itemBottom > viewBottom)\n            return true;\n            \n        return false;\n    }\n\t\n\tdoscroll(event: Event) {\t\t\n\t\tvar target = <Element>(typeof event.srcElement === 'undefined' ? event.target : event.srcElement);\n\t\tvar targetRect = target.getBoundingClientRect();\n\t\tvar bottomPosition = target.scrollHeight - (target.scrollTop + targetRect.height);\n\t\t\n\t\tvar scrollDown = target.scrollTop > this.lastScroll;\n\t\tvar saveLastScroll = this.lastScroll;\n\t\tthis.lastScroll = target.scrollTop;\n\t\t\n\t\tif(scrollDown && target.scrollHeight - (target.scrollTop + targetRect.height) <= this.distance*2) {\n\t\t\tthis.next.emit(null);\n\t\t\tif(target.scrollHeight - target.scrollTop === target.clientHeight) {\n\t\t\t\ttarget.scrollTop -= 10;\n\t\t\t}\n\t\t} \n\t\telse if(!scrollDown && target.scrollTop <= this.distance*2) {\n\t\t\tthis.prev.emit(null);\n\t\t}\n\t\t\n        this.getVisableIndicies();\n        \n        if(target.scrollTop < 1)\n            target.scrollTop = 1;\n\t}\n    \n    scrollTo(position: number, animate = true): void {\n        if(animate)\n            ElementUtils.scrollTo(this.container, position, 400);\n        else \n            this.container.scrollTop = position;\n    }\n    \n    scrollToIndex(index: number, animate = true): void {\n        var itemArray = this.itemQuery.toArray();\n        \n        var targetIndex = 0;\n        if(index > 0 && index < itemArray.length)\n            targetIndex = index;\n        else if(index >= itemArray.length)\n            targetIndex = itemArray.length - 1;\n        \n        if(targetIndex < 0)\n            targetIndex = 0;\n        \n        var target = this.itemQuery.toArray()[targetIndex];\n        var targetPos = target.element.offsetTop - this.container.offsetTop;\n        this.scrollTo(targetPos, animate);\n    }\n    \n    isTop(): boolean {\n       return this.lastScroll <= 1;\n    }\n    \n    isBottom(): boolean {\n        return (this.lastScroll + this.container.clientHeight) >= this.container.scrollHeight - 10;\n    }\n}\n\nexport var INFINITE_SCROLLER_PROVIDERS = [\n    InfiniteScroller, ScrollItem\n]"],"sourceRoot":"/source/"}